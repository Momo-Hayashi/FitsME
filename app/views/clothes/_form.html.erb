<article>
  <%= form_with(model: @clothe, local: true) do |form| %>

    <% if clothe.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(clothe.errors.count, "error") %> prohibited this clothes from being saved:</h2>
        <ul>
        <% clothe.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
        </ul>
      </div>
    <% end %>

    <div class="actions">
      <div class="form-group row">
        <%= form.label :アイテム名, class: "col-sm-2 col-form-label" %><br>
        <%= form.text_field :name, class: "col-sm-10 form-control", placeholder: "name of the item" %>
      </div>

      <div class="form-group row">
        <%= form.label :アイテム詳細, class: "col-sm-2 col-form-label" %><br>
        <%= form.text_area :description, class: "col-sm-10 form-control",
         placeholder: "商品のアピールポイントをご記入ください。
          例：美脚効果抜群！待望のスラックスパンツが遂に登場！！" %>
      </div>

      <div class="form-group row">
        <%= form.label :サイズ, class: "col-sm-2 col-form-label" %><br>
        <%= form.text_area :size, class: "col-sm-10 form-control",
         placeholder: "商品のサイズの詳細をご記入ください。
          例：サイズ：身幅 肩幅 着丈 そで丈
                S :  47   38  60   52
                M :  51   42  68   59" %>
      </div>

      <div class="category_fields row">
        <% Category.all.order("id ASC").limit(20).each do |category| %>
          <div class="field col-sm-3">
            <div class="dropdown">
              <button class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <%= category.name %>
              </button>
              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item"><%= form.collection_check_boxes(:category_ids, category.children, :id, :name) %></a>
              </div>
            </div>
          </div>
        <% end %>
        <% if @clothe.categories.present? %>
          <p>現在選択したカテゴリー：</p>
          <% @clothe.categories.each do |category| %>
            <p> <%= category.name %> / </p>
          <% end %>
        <% end %>
      </div><br>

      <div class="form-group row">
        <%= form.label :Price, class: "col-sm-2 col-form-label" %><br>
        <%= form.number_field :price, class: "col-sm-5 form-control", placeholder: "10000" %>円（税込）
      </div><br>

      <div class="field images">
        <strong><%= form.label :'Images of the item' %></strong><br>
        <% if clothe.images.attached? %>
          <p>現在登録されている画像（削除するものはチェックしてください）</p>
          <% clothe.images.each do |image| %>
            <%= form.check_box :image_ids, {multiple: true}, image.id, false %>
            <%= image_tag image.variant(resize: "250x250") %>
          <% end %>
        <% end %><br>
        <%= form.file_field :images, multiple: true %>
      </div><br><br>

      <div class="field stocks">
        <h5>ストック情報</h5>
        <p>*サイズ・カラーごとに在庫数をご記入ください</p>
        <table>
          <%= form.fields_for :stocks do |stock| %>
            <tr>
              <th><%= stock.label :Size %></th>
              <th><%= stock.label :Color %></th>
              <th><%= stock.label :数量 %></th>
            </tr>
            <tr>
              <td><%= stock.select :size, Stock.sizes.keys.to_a {}, include_blank: true %></td>
              <td><%= stock.select :color, Stock.colors.keys.to_a {}, include_blank: true %></td>
              <td><%= stock.text_field :quantity, placeholder: "50" %></td>
              <%# <% if @clothe.stocks.pluck(:id).include?(stock.id) %>
                <%# <!-- <td><%= form.check_box :stock_ids, {multiple: true}, stock.id, false %></td>
              <%# <% end %>
            </tr>
          <% end %>
        </table>
        <div id="links">
          <%= link_to_add_association "サイズ・カラーをさらに追加する", form, :stocks %>
        </div>
      </div>

      <br>
      <%= form.submit %>
    </div>
  <% end %>
</article>
